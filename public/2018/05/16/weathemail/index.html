<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="“想不想每天给她/他发送一条天气提醒呢”  起因 魔都的天气，太魔性了…尤其是梅雨季 ios自带天气app无提醒，经常忘记查看。使用过 Mr.Weather、Colorful Pro，提醒又过多，导致通知栏里全是天气通知 需求其实很简单，一份简介明了又不扰人的天气提醒 使用邮件无需额外费用，比短信提醒易于实现，使用node.js更是十分简单   Setup使用node.js实现天气获取与邮件发送">
<meta name="keywords" content="fun">
<meta property="og:type" content="article">
<meta property="og:title" content="50行实现定时发送天气预报提醒邮件">
<meta property="og:url" content="http://miyunluo.com/2018/05/16/weathemail/index.html">
<meta property="og:site_name" content="miyunLuo">
<meta property="og:description" content="“想不想每天给她/他发送一条天气提醒呢”  起因 魔都的天气，太魔性了…尤其是梅雨季 ios自带天气app无提醒，经常忘记查看。使用过 Mr.Weather、Colorful Pro，提醒又过多，导致通知栏里全是天气通知 需求其实很简单，一份简介明了又不扰人的天气提醒 使用邮件无需额外费用，比短信提醒易于实现，使用node.js更是十分简单   Setup使用node.js实现天气获取与邮件发送">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://miyunluo.com/images/in-post/post-blog-POP3SMTPIMAP.png">
<meta property="og:image" content="http://miyunluo.com/images/in-post/post-blog-AuthCode.png">
<meta property="og:image" content="http://miyunluo.com/images/in-post/post-blog-WeatherEmail.jpg">
<meta property="og:updated_time" content="2018-05-16T12:10:41.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="50行实现定时发送天气预报提醒邮件">
<meta name="twitter:description" content="“想不想每天给她/他发送一条天气提醒呢”  起因 魔都的天气，太魔性了…尤其是梅雨季 ios自带天气app无提醒，经常忘记查看。使用过 Mr.Weather、Colorful Pro，提醒又过多，导致通知栏里全是天气通知 需求其实很简单，一份简介明了又不扰人的天气提醒 使用邮件无需额外费用，比短信提醒易于实现，使用node.js更是十分简单   Setup使用node.js实现天气获取与邮件发送">
<meta name="twitter:image" content="http://miyunluo.com/images/in-post/post-blog-POP3SMTPIMAP.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-200x200.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>50行实现定时发送天气预报提醒邮件</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/research/">Research</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/06/14/escpfromnetease/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/05/06/NeuralArtisticStyle/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://miyunluo.com/2018/05/16/weathemail/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://miyunluo.com/2018/05/16/weathemail/&text=50行实现定时发送天气预报提醒邮件"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://miyunluo.com/2018/05/16/weathemail/&title=50行实现定时发送天气预报提醒邮件"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://miyunluo.com/2018/05/16/weathemail/&is_video=false&description=50行实现定时发送天气预报提醒邮件"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=50行实现定时发送天气预报提醒邮件&body=Check out this article: http://miyunluo.com/2018/05/16/weathemail/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://miyunluo.com/2018/05/16/weathemail/&title=50行实现定时发送天气预报提醒邮件"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://miyunluo.com/2018/05/16/weathemail/&title=50行实现定时发送天气预报提醒邮件"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://miyunluo.com/2018/05/16/weathemail/&title=50行实现定时发送天气预报提醒邮件"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://miyunluo.com/2018/05/16/weathemail/&title=50行实现定时发送天气预报提醒邮件"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://miyunluo.com/2018/05/16/weathemail/&name=50行实现定时发送天气预报提醒邮件&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#起因"><span class="toc-number">1.</span> <span class="toc-text">起因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup"><span class="toc-number">2.</span> <span class="toc-text">Setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注册Heweather"><span class="toc-number">3.</span> <span class="toc-text">注册Heweather</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开启SMTP"><span class="toc-number">4.</span> <span class="toc-text">开启SMTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题分解"><span class="toc-number">5.</span> <span class="toc-text">问题分解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#完整代码"><span class="toc-number">6.</span> <span class="toc-text">完整代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最终效果"><span class="toc-number">7.</span> <span class="toc-text">最终效果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最后"><span class="toc-number">8.</span> <span class="toc-text">最后</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        50行实现定时发送天气预报提醒邮件
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">miyunLuo</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-05-15T16:00:00.000Z" itemprop="datePublished">2018-05-16</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/fun/">fun</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote>
<p>“想不想每天给她/他发送一条天气提醒呢”</p>
</blockquote>
<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><ol>
<li>魔都的天气，太魔性了…尤其是梅雨季</li>
<li>ios自带天气app无提醒，经常忘记查看。使用过 Mr.Weather、Colorful Pro，提醒又过多，导致通知栏里全是天气通知</li>
<li>需求其实很简单，一份简介明了又不扰人的天气提醒</li>
<li>使用邮件无需额外费用，比短信提醒易于实现，使用node.js更是十分简单</li>
</ol>
<hr>
<h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><p>使用node.js实现天气获取与邮件发送，首先需要安装node。</p>
<ul>
<li><p>macOS 推荐使用 homebrew 进行安装，也可下载Installer安装</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span>$ brew install node</span><br></pre></td></tr></table></figure>
</li>
<li><p>Ubuntu</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span>$ curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -</span><br><span class="line"><span class="meta">&gt;</span>$ sudo apt-get install -y nodejs</span><br></pre></td></tr></table></figure>
</li>
<li><p>Windows</p>
<p>直接下载Installer <a href="https://nodejs.org/en/download" target="_blank" rel="noopener">https://nodejs.org/en/download</a></p>
</li>
</ul>
<h2 id="注册Heweather"><a href="#注册Heweather" class="headerlink" title="注册Heweather"></a>注册Heweather</h2><p>获取天气信息需要依赖提供天气查询服务的网站。在对比了和风天气与丫丫天气后，发现同为免费用户的情况下，和风天气提供的信息更为全面，这里使用和风。(至今没收到丫丫的验证邮件…)</p>
<ul>
<li><p>用户注册</p>
<p>地址：<a href="http://www.heweather.com" target="_blank" rel="noopener">http://www.heweather.com</a></p>
</li>
<li><p>获得想要查询城市或区域的编码：</p>
<p>地址：<a href="https://www.heweather.com/documents/city" target="_blank" rel="noopener">https://www.heweather.com/documents/city</a></p>
<p>如 松江区：CN101020900，闵行区：CN101020200。</p>
</li>
<li><p>获得认证key</p>
<p>注册后登录，地址：控制台-&gt;我的控制台-&gt;认证key</p>
</li>
<li><p>免费查询api</p>
<p>根据和风天气文档，获取天气信息大合集的url如下，返回一份json数据，具体字段信息请参考官方文档</p>
<p><a href="https://free-api.heweather.com/s6/weather?location=CITY_CODE&amp;key=YOUR_KEY" target="_blank" rel="noopener">https://free-api.heweather.com/s6/weather?location=CITY_CODE&amp;key=YOUR_KEY</a></p>
<p>将 <strong>CITY_CODE</strong> 替换为第二步得到的城市代码，如CN101020900</p>
<p>将 <strong>YOUR_KEY</strong> 替换为第三步自己的key</p>
</li>
</ul>
<h2 id="开启SMTP"><a href="#开启SMTP" class="headerlink" title="开启SMTP"></a>开启SMTP</h2><p>使用smtp协议进行邮件发送，需要开启邮箱的smtp服务，一般在邮箱的设置中。</p>
<p>以163邮箱为例，smtp在 设置-&gt;POP3/SMTP/IMAP 选项下。</p>
<p><img src="/images/in-post/post-blog-POP3SMTPIMAP.png" alt="img"></p>
<p>初次开启，会要求设置授权码，此授权码就是之后使用smtp协议发邮件时的密码，注意与邮箱登录密码区别。</p>
<p><img src="/images/in-post/post-blog-AuthCode.png" alt="img"></p>
<p>QQ邮箱开启方法类似。</p>
<hr>
<h2 id="问题分解"><a href="#问题分解" class="headerlink" title="问题分解"></a>问题分解</h2><ol>
<li><strong>请求并处理天气数据</strong></li>
</ol>
<p>首先当然是要获得需要的天气数据，由于要进行网络请求，这里使用 <code>request</code> 模块。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> request=<span class="built_in">require</span>(<span class="string">'request'</span>);</span><br><span class="line"><span class="keyword">const</span> url= <span class="string">'https://free-api.heweather.com/s6/weather?location=***********&amp;key=********************************'</span>;</span><br><span class="line">request(url,(error,response,body)=&gt;&#123;&#125;;</span><br></pre></td></tr></table></figure>
<p>返回参数 <code>body</code> 包含我们需要的天气信息，部分信息格式化后的内容如下。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"HeWeather6"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"basic"</span>: &#123;</span><br><span class="line">                <span class="attr">"cid"</span>: <span class="string">"CN101020900"</span>, </span><br><span class="line">                <span class="attr">"location"</span>: <span class="string">"松江"</span>, </span><br><span class="line">                <span class="attr">"parent_city"</span>: <span class="string">"上海"</span>, </span><br><span class="line">                <span class="attr">"admin_area"</span>: <span class="string">"上海"</span>, </span><br><span class="line">                <span class="attr">"cnty"</span>: <span class="string">"中国"</span>, </span><br><span class="line">                <span class="attr">"lat"</span>: <span class="string">"31.03046989"</span>, </span><br><span class="line">                <span class="attr">"lon"</span>: <span class="string">"121.22354126"</span>, </span><br><span class="line">                <span class="attr">"tz"</span>: <span class="string">"+8.00"</span></span><br><span class="line">            &#125;, </span><br><span class="line">            <span class="attr">"status"</span>: <span class="string">"ok"</span>, </span><br><span class="line">            <span class="attr">"now"</span>: &#123;</span><br><span class="line">                <span class="attr">"cloud"</span>: <span class="string">"0"</span>, </span><br><span class="line">                <span class="attr">"cond_code"</span>: <span class="string">"101"</span>, </span><br><span class="line">                <span class="attr">"cond_txt"</span>: <span class="string">"多云"</span>, </span><br><span class="line">                <span class="attr">"fl"</span>: <span class="string">"38"</span>, </span><br><span class="line">                <span class="attr">"hum"</span>: <span class="string">"56"</span>, </span><br><span class="line">                <span class="attr">"pcpn"</span>: <span class="string">"0.0"</span>, </span><br><span class="line">                <span class="attr">"pres"</span>: <span class="string">"1003"</span>, </span><br><span class="line">                <span class="attr">"tmp"</span>: <span class="string">"34"</span>, </span><br><span class="line">                <span class="attr">"vis"</span>: <span class="string">"10"</span>, </span><br><span class="line">                <span class="attr">"wind_deg"</span>: <span class="string">"123"</span>, </span><br><span class="line">                <span class="attr">"wind_dir"</span>: <span class="string">"东南风"</span>, </span><br><span class="line">                <span class="attr">"wind_sc"</span>: <span class="string">"2"</span>, </span><br><span class="line">                <span class="attr">"wind_spd"</span>: <span class="string">"6"</span></span><br><span class="line">            &#125;, </span><br><span class="line">            <span class="attr">"daily_forecast"</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">"cond_code_d"</span>: <span class="string">"100"</span>, </span><br><span class="line">                    <span class="attr">"cond_code_n"</span>: <span class="string">"101"</span>, </span><br><span class="line">                    <span class="attr">"cond_txt_d"</span>: <span class="string">"晴"</span>, </span><br><span class="line">                    <span class="attr">"cond_txt_n"</span>: <span class="string">"多云"</span>, </span><br><span class="line">                    <span class="attr">"date"</span>: <span class="string">"2018-05-16"</span>, </span><br><span class="line">                    <span class="attr">"hum"</span>: <span class="string">"74"</span>, </span><br><span class="line">                    <span class="attr">"mr"</span>: <span class="string">"05:40"</span>, </span><br><span class="line">                    <span class="attr">"ms"</span>: <span class="string">"19:34"</span>, </span><br><span class="line">                    <span class="attr">"pcpn"</span>: <span class="string">"0.0"</span>, </span><br><span class="line">                    <span class="attr">"pop"</span>: <span class="string">"0"</span>, </span><br><span class="line">                    <span class="attr">"pres"</span>: <span class="string">"1005"</span>, </span><br><span class="line">                    <span class="attr">"sr"</span>: <span class="string">"04:59"</span>, </span><br><span class="line">                    <span class="attr">"ss"</span>: <span class="string">"18:44"</span>, </span><br><span class="line">                    <span class="attr">"tmp_max"</span>: <span class="string">"36"</span>, </span><br><span class="line">                    <span class="attr">"tmp_min"</span>: <span class="string">"25"</span>, </span><br><span class="line">                    <span class="attr">"uv_index"</span>: <span class="string">"10"</span>, </span><br><span class="line">                    <span class="attr">"vis"</span>: <span class="string">"13"</span>, </span><br><span class="line">                    <span class="attr">"wind_deg"</span>: <span class="string">"181"</span>, </span><br><span class="line">                    <span class="attr">"wind_dir"</span>: <span class="string">"南风"</span>, </span><br><span class="line">                    <span class="attr">"wind_sc"</span>: <span class="string">"4-5"</span>, </span><br><span class="line">                    <span class="attr">"wind_spd"</span>: <span class="string">"25"</span></span><br><span class="line">                &#125;, </span><br><span class="line">                </span><br><span class="line">            ], </span><br><span class="line">            ......</span><br></pre></td></tr></table></figure>
<p>当然根据和风天气的文档，已知这是一个json文件，直接使用json parser对 <code>body</code> 处理即可。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data=<span class="built_in">JSON</span>.parse(body);</span><br><span class="line">data=data.HeWeather6[<span class="number">0</span>];</span><br></pre></td></tr></table></figure>
<p>json中包含的信息比较多，可以筛选一些重要的信息来使用。比如 日出时间: <code>daliy_forecast.sr</code>，日落时间: <code>daliy_forecast.ss</code>，最高温度: <code>daliy_forecast.tmp_max</code>，最低温度: <code>daliy_forecast.tmp_min</code>，降水概率: <code>daliy_forecast.pop</code> 等。</p>
<ol start="2">
<li><strong>邮件编排</strong></li>
</ol>
<p>获得了天气数据后，就可以发送邮件了，但是如何编辑排列得到的天气数据也是一个需要考虑的问题，发一堆杂乱无章的数据，视觉观感不好。当然邮件本身支持html样式，可以编写一个简单的html样式来排列邮件内容。</p>
<p>最终进行邮件发送时，只需要将这一样式表拼接为字符串即可。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>给主席的天气预报<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">style</span>=<span class="string">"margin:20px auto 10px auto"</span>&gt;</span> data.daily_forecast[0].date   data.basic.location 区<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span>日出时间: <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span> data.daily_forecast[0].sr <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"width:40%;margin-left: 30px"</span>&gt;</span>日落时间: <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span> data.daily_forecast[0].ss+ <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span>白天: <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span> data.daily_forecast[0].cond_txt_d <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"width:40%;margin-left: 30px"</span>&gt;</span>晚间: <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span> data.daily_forecast[0].cond_txt_n <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span>最高温度: <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>data.daily_forecast[0].tmp_max<span class="tag">&lt;/<span class="name">b</span>&gt;</span>℃<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"width:40%;margin-left: 30px"</span>&gt;</span>最低温度: <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>data.daily_forecast[0].tmp_min<span class="tag">&lt;/<span class="name">b</span>&gt;</span>℃<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span>紫外线强度指数: <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>data.daily_forecast[0].uv_index<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span>降水概率: <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span>data.daily_forecast[0].pop %<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span>风力: <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span> data.daily_forecast[0].wind_sc <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span>穿衣建议: <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">span</span>&gt;</span> data.lifestyle[1].txt <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">     	<span class="tag">&lt;<span class="name">small</span>&gt;</span>注 紫外线强度: 0-2 无危险 | 3-5 较轻伤害 | 6-7 很大伤害 | 8-10 极高伤害 | 11+ 及其危险<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li><strong>邮件发送</strong></li>
</ol>
<p>发送邮件使用 <code>nodemailer</code> 模块。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> nodemailer=<span class="built_in">require</span>(<span class="string">'nodemailer'</span>);</span><br><span class="line"><span class="comment">// 建立SMTP连接</span></span><br><span class="line"><span class="keyword">var</span> smtpTransport = nodemailer.createTransport(&#123;</span><br><span class="line">  host: <span class="string">"smtp.163.com"</span>, <span class="comment">// smtp主机</span></span><br><span class="line">  secureConnection: <span class="literal">true</span>, <span class="comment">// 使用SSL</span></span><br><span class="line">  port: <span class="number">465</span>, <span class="comment">// SMTP 端口</span></span><br><span class="line">  auth: &#123;</span><br><span class="line">    user: <span class="string">"邮箱前缀@163.com"</span>, <span class="comment">// 账号</span></span><br><span class="line">    pass: <span class="string">"******"</span> <span class="comment">// 授权码</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 设置邮件内容</span></span><br><span class="line"><span class="keyword">var</span> mailOptions = &#123;</span><br><span class="line">  <span class="keyword">from</span>: <span class="string">"名字 &lt;邮箱前缀@163.com&gt;"</span>, <span class="comment">// 发件地址</span></span><br><span class="line">  to: <span class="string">"XXXXXXX@example.com"</span>, <span class="comment">// 收件地址</span></span><br><span class="line">  subject: <span class="string">"Hello"</span>, <span class="comment">// 标题</span></span><br><span class="line">  html: <span class="string">"&lt;b&gt;邮件由nodemailer发送&lt;/b&gt;"</span> <span class="comment">// html实例，替换为第2步的天气内容</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 发送邮件</span></span><br><span class="line">smtpTransport.sendMail(mailOptions, <span class="function"><span class="keyword">function</span>(<span class="params">error, response</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(error)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Message sent: "</span> + response.message);</span><br><span class="line">  &#125;</span><br><span class="line">  smtpTransport.close(); <span class="comment">// 关闭连接</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ol start="4">
<li><strong>定时</strong></li>
</ol>
<p>Unix 与 Linux本身提供了定时启动指令 <code>crontab</code>，当然 node.js 也有自己的定时器，而且使用起来更加方便。</p>
<p>使用模块 <code>node-schedule</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> schedule=<span class="built_in">require</span>(<span class="string">'node-schedule'</span>);</span><br><span class="line"><span class="keyword">var</span> rule = <span class="keyword">new</span> schedule.RecurrenceRule();</span><br><span class="line">rule.hour = <span class="number">6</span>; rule.minute = <span class="number">30</span>; rule.second = <span class="number">0</span>; <span class="comment">// 定时 06:30:00</span></span><br><span class="line"><span class="keyword">var</span> run = schedule.scheduleJob(rule, YOUR_FUNC); <span class="comment">// YOUR_FUNC 为想要执行的函数</span></span><br></pre></td></tr></table></figure>
<p>至此所有模块已经基本完成，之后将天气查询，与邮件发送功能封装在一个函数中，传入 <code>schudle.scheduleJob</code> 即可。</p>
<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> request = <span class="built_in">require</span>(<span class="string">'request'</span>);</span><br><span class="line"><span class="keyword">const</span> nodemailer = <span class="built_in">require</span>(<span class="string">'nodemailer'</span>);</span><br><span class="line"><span class="keyword">const</span> schedule = <span class="built_in">require</span>(<span class="string">'node-schedule'</span>);</span><br><span class="line"><span class="keyword">var</span> rule = <span class="keyword">new</span> schedule.RecurrenceRule();</span><br><span class="line">rule.hour = <span class="number">6</span>; rule.minute = <span class="number">30</span>; rule.second = <span class="number">0</span>; <span class="comment">// 设置定时发送的时间</span></span><br><span class="line"><span class="keyword">var</span> data= <span class="string">''</span>;</span><br><span class="line"><span class="keyword">var</span> j = schedule.scheduleJob(rule, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'发送天气预报...'</span>);</span><br><span class="line">  	sendWeather();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendWeather</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">const</span> url= <span class="string">'https://free-api.heweather.com/s6/weather/forecast?location=城市代码&amp;key=自己的key'</span>; <span class="comment">// 城市代码: 从和风天气文档获得，key: 注册和风天气得到</span></span><br><span class="line">	request(url,(error,response,body)=&gt;&#123;</span><br><span class="line">		<span class="keyword">if</span>(error)&#123;</span><br><span class="line">			<span class="built_in">console</span>.log(error);</span><br><span class="line">		&#125;</span><br><span class="line">		data=<span class="built_in">JSON</span>.parse(body);</span><br><span class="line">		data=data.HeWeather6[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">		<span class="keyword">let</span> transporter=nodemailer.createTransport(&#123;</span><br><span class="line">		host: <span class="string">"smtp.163.com"</span>, <span class="comment">// 163邮箱的smtp服务器地址</span></span><br><span class="line">		port: <span class="number">465</span>,</span><br><span class="line">		secureConnection: <span class="literal">true</span>,</span><br><span class="line">		auth: &#123;</span><br><span class="line">			user:<span class="string">'邮箱前缀@163.com'</span>, <span class="comment">// 邮箱地址</span></span><br><span class="line">			pass:<span class="string">'*******'</span> <span class="comment">// smtp授权码，不是邮箱的登录密码</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="keyword">let</span> mailOptions=&#123;</span><br><span class="line">			<span class="keyword">from</span>: <span class="string">"预报君 &lt;邮箱前缀@163.com&gt;"</span>, <span class="comment">// 与发件地址一致，否则报错</span></span><br><span class="line">			to: <span class="string">"to someone @foxmail.com"</span>, <span class="comment">// 要发送的邮箱地址</span></span><br><span class="line">			subject: data.daily_forecast[<span class="number">0</span>].date + <span class="string">'の天気'</span>,</span><br><span class="line">			text:<span class="string">'城市 :'</span>+data.basic.location+<span class="string">'时间：'</span>+ data.daily_forecast[<span class="number">0</span>].date,</span><br><span class="line">			html: <span class="string">'&lt;div&gt;&lt;div&gt;&lt;h1&gt;给主席的天气预报&lt;/h1&gt;&lt;/div&gt;&lt;div&gt;&lt;h3 style="margin:20px auto 10px auto"&gt;'</span> + data.daily_forecast[<span class="number">0</span>].date + <span class="string">' '</span> + data.basic.location + <span class="string">'区&lt;/h3&gt;&lt;div&gt;&lt;p&gt;&lt;span&gt;日出时间: &lt;/span&gt;&lt;span&gt;'</span>+data.daily_forecast[<span class="number">0</span>].sr+<span class="string">'&lt;/span&gt;&lt;span style="width:40%;margin-left: 30px"&gt;日落时间: &lt;/span&gt;&lt;span&gt;'</span>+data.daily_forecast[<span class="number">0</span>].ss+<span class="string">'&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;白天: &lt;/span&gt;&lt;span&gt;'</span>+data.daily_forecast[<span class="number">0</span>].cond_txt_d+<span class="string">'&lt;/span&gt;&lt;span style="width:40%;margin-left: 30px"&gt;晚间: &lt;/span&gt;&lt;span&gt;'</span>+data.daily_forecast[<span class="number">0</span>].cond_txt_n+<span class="string">'&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;最高温度: &lt;/span&gt;&lt;span&gt;&lt;b&gt;'</span>+data.daily_forecast[<span class="number">0</span>].tmp_max+<span class="string">'&lt;/b&gt;℃&lt;/span&gt;&lt;span style="width:40%;margin-left: 30px"&gt;最低温度: &lt;/span&gt;&lt;span&gt;&lt;b&gt;'</span>+data.daily_forecast[<span class="number">0</span>].tmp_min+<span class="string">'&lt;/b&gt;℃&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;紫外线强度指数: &lt;/span&gt;&lt;span&gt;&lt;b&gt;'</span>+data.daily_forecast[<span class="number">0</span>].uv_index+<span class="string">'&lt;/b&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;降水概率: &lt;/span&gt;&lt;span&gt;'</span>+data.daily_forecast[<span class="number">0</span>].pop+<span class="string">' %&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;风力: &lt;/span&gt;&lt;span&gt;'</span>+data.daily_forecast[<span class="number">0</span>].wind_sc+<span class="string">'&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;穿衣建议: &lt;/span&gt;&lt;span&gt;'</span> + data.lifestyle[<span class="number">1</span>].txt + <span class="string">'&lt;/span&gt;&lt;/p&gt;&lt;br&gt;&lt;p&gt;&lt;small&gt;注 紫外线强度: 0-2 无危险 | 3-5 较轻伤害 | 6-7 很大伤害 | 8-10 极高伤害 | 11+ 及其危险&lt;/small&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;'</span></span><br><span class="line">		&#125;;</span><br><span class="line">		transporter.sendMail(mailOptions,(err,info)=&gt;&#123;</span><br><span class="line">			<span class="keyword">if</span>(err)&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="built_in">console</span>.log(err);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="built_in">console</span>.log(<span class="string">'Message %s sent %s'</span>,info.messageId,info.response);</span><br><span class="line">			&#125;</span><br><span class="line">			transporter.close();</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h2><p><img src="/images/in-post/post-blog-WeatherEmail.jpg" alt="img"></p>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>只需要不到50行就可以自动发送天气邮件了，你是不是也想给她/他每天发一条天气提醒呢？不妨试一试。<a href="https://github.com/miyunluo/Funny_Tools/tree/master/Weather_Email_Reporter" target="_blank" rel="noopener">github</a></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/research/">Research</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#起因"><span class="toc-number">1.</span> <span class="toc-text">起因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup"><span class="toc-number">2.</span> <span class="toc-text">Setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注册Heweather"><span class="toc-number">3.</span> <span class="toc-text">注册Heweather</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开启SMTP"><span class="toc-number">4.</span> <span class="toc-text">开启SMTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题分解"><span class="toc-number">5.</span> <span class="toc-text">问题分解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#完整代码"><span class="toc-number">6.</span> <span class="toc-text">完整代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最终效果"><span class="toc-number">7.</span> <span class="toc-text">最终效果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最后"><span class="toc-number">8.</span> <span class="toc-text">最后</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://miyunluo.com/2018/05/16/weathemail/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://miyunluo.com/2018/05/16/weathemail/&text=50行实现定时发送天气预报提醒邮件"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://miyunluo.com/2018/05/16/weathemail/&title=50行实现定时发送天气预报提醒邮件"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://miyunluo.com/2018/05/16/weathemail/&is_video=false&description=50行实现定时发送天气预报提醒邮件"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=50行实现定时发送天气预报提醒邮件&body=Check out this article: http://miyunluo.com/2018/05/16/weathemail/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://miyunluo.com/2018/05/16/weathemail/&title=50行实现定时发送天气预报提醒邮件"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://miyunluo.com/2018/05/16/weathemail/&title=50行实现定时发送天气预报提醒邮件"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://miyunluo.com/2018/05/16/weathemail/&title=50行实现定时发送天气预报提醒邮件"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://miyunluo.com/2018/05/16/weathemail/&title=50行实现定时发送天气预报提醒邮件"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://miyunluo.com/2018/05/16/weathemail/&name=50行实现定时发送天气预报提醒邮件&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Yudong Luo
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/research/">Research</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/fontawesome-all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-102635433-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


<!-- Mathjax -->

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


